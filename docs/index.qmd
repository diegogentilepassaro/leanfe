---
title: "leanfe"
subtitle: "Lean, Fast Fixed Effects Regression"
page-layout: full
toc: false
---

::: {.hero-banner}

# üçÉüí® leanfe

### Lean, Fast Fixed Effects Regression for Python and R

High-dimensional fixed effects regression that's **fast** when you need speed, and **memory-efficient** when you're working with data larger than RAM.

::: {.hero-buttons}
[Get Started](get-started.qmd){.btn .btn-primary .btn-lg}
[View on GitHub](https://github.com/diegogentilepassaro/leanfe){.btn .btn-outline-secondary .btn-lg}
:::

:::

## Why leanfe?

::: {.grid}

::: {.g-col-12 .g-col-md-6 .g-col-lg-3}
### ‚ö° Speed
**YOCO + sparse matrices** compress data 10-1000x and solve 20x faster. Process millions of observations in seconds.
:::

::: {.g-col-12 .g-col-md-6 .g-col-lg-3}
### üíæ Memory Efficient
**DuckDB backend** processes datasets larger than RAM by streaming from disk. Memory usage stays low regardless of dataset size.
:::

::: {.g-col-12 .g-col-md-6 .g-col-lg-3}
### üîÑ Unified API
**Same syntax** in Python and R. Switch languages without relearning. The API works identically in both.
:::

::: {.g-col-12 .g-col-md-6 .g-col-lg-3}
### üìä Complete Features
**Full econometrics toolkit**: clustered standard errors, factor variables, interactions, IV/2SLS, and more.
:::

:::

## How It Works: YOCO + Sparse Matrices

leanfe achieves its speed through two key innovations:

### 1. YOCO Compression (You Only Compress Once)

For IID and HC1 standard errors, many observations share the same regressor values. Instead of processing each row individually, leanfe groups identical rows together:

```
Original: 5M rows with binary treatment √ó 500 firms √ó 100 products
Compressed: ~100K unique combinations (98% reduction!)
```

The math is **lossless** ‚Äî coefficients and standard errors are identical to the full computation, just computed on sufficient statistics (count, sum, sum of squares) per group.

### 2. Sparse FE Dummies

With 500 firms + 100 products, the design matrix has ~600 FE dummy columns. But each row only has **2 non-zeros** (one per FE). Sparse matrices:

- **Store only non-zeros**: 99.7% memory reduction
- **Skip zero operations**: Matrix multiplication is 10x faster
- **Scale effortlessly**: Adding more FE levels costs almost nothing

### The Result

| Dataset | Traditional | leanfe | Speedup |
|---------|-------------|--------|---------|
| 1M rows | 0.7s | 0.09s | **7.7x** |
| 5M rows | 3.7s | 0.15s | **24.6x** |

[Learn more about the methodology ‚Üí](benchmarks/methodology.qmd)

## Quick Example

Two-way fixed effects regression with clustered standard errors:

::: {.panel-tabset}

### Python (Polars)

```python
from leanfe import leanfe

# Fast in-memory computation (default)
result = leanfe(
    formula="outcome ~ treatment + controls | unit_id + time_id",
    data=df,
    vcov="cluster",
    cluster_cols=["unit_id"],
    backend="polars"  # default, fastest
)
```

### Python (DuckDB)

```python
from leanfe import leanfe

# Memory-efficient, can handle data larger than RAM
result = leanfe(
    formula="outcome ~ treatment + controls | unit_id + time_id",
    data="large_data.parquet",  # read directly from file
    vcov="cluster",
    cluster_cols=["unit_id"],
    backend="duckdb"  # low memory usage
)
```

### R (Polars)

```r
library(leanfe)

# Fast in-memory computation (default)
result <- leanfe(
    formula = "outcome ~ treatment + controls | unit_id + time_id",
    data = df,
    vcov = "cluster",
    cluster_cols = c("unit_id"),
    backend = "polars"
)
```

### R (DuckDB)

```r
library(leanfe)

# Memory-efficient, can handle data larger than RAM
result <- leanfe(
    formula = "outcome ~ treatment + controls | unit_id + time_id",
    data = "large_data.parquet",
    vcov = "cluster",
    cluster_cols = c("unit_id"),
    backend = "duckdb"
)
```

:::

## Performance

**YOCO + sparse matrices** make leanfe extremely fast for IID/HC1 standard errors. DuckDB uses far less memory and can process datasets larger than RAM.

### Python (IID Standard Errors with YOCO + Sparse)

| Dataset Size | Polars | DuckDB | Compression |
|-------------|--------|--------|-------------|
| 100K obs | 0.05s | 0.5s | 60% |
| 1M obs | 0.09s | 0.8s | 10% |
| 5M obs | 0.15s | 1.5s | 2% |

### Python (Clustered SEs - Traditional FWL)

| Dataset Size | Polars | DuckDB | 
|-------------|--------|--------|
| 100K obs | 0.08s | 0.1s |
| 1M obs | 0.7s | 1.0s |
| 5M obs | 3.5s | 5.0s |

**YOCO speedup**: 7-25x faster than traditional FWL for IID/HC1 standard errors.

[View detailed benchmarks ‚Üí](benchmarks/overview.qmd)

## Installation

::: {.panel-tabset}

### Python

```bash
pip install leanfe
```

Or install from source:

```bash
pip install git+https://github.com/diegogentilepassaro/leanfe.git#subdirectory=package/python
```

### R

```r
# Install from GitHub
remotes::install_github("diegogentilepassaro/leanfe", subdir = "package/r")
```

:::

## Ready to dive in?

::: {.grid}

::: {.g-col-12 .g-col-md-4}
### üìñ Tutorials
Step-by-step guides for common use cases: DiD, event studies, IV regression.

[Browse tutorials ‚Üí](tutorials/basic-usage.qmd)
:::

::: {.g-col-12 .g-col-md-4}
### üìö API Reference
Complete documentation of all functions and parameters.

[Python API](reference/python.qmd) | [R API](reference/r.qmd)
:::

::: {.g-col-12 .g-col-md-4}
### üî¨ Benchmarks
Reproducible performance comparisons with PyFixest and fixest.

[View benchmarks ‚Üí](benchmarks/overview.qmd)
:::

:::
